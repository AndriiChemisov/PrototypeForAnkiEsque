<UserControl x:Class="PrototypeForAnkiEsque.Views.FlashcardDeckEditorUserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Height="450" Width="800"
             DataContext="{Binding RelativeSource={RelativeSource Self}}">

    <Grid>
        <!-- Navigation Button -->
        <Button Content="Back" HorizontalAlignment="Left" VerticalAlignment="Top" 
                Margin="10" Command="{Binding OpenDeckSelectionCommand}" />
        <TextBlock Text="Deck Name" HorizontalAlignment="Center" VerticalAlignment="Top" />
        <TextBox Text="{Binding DeckName, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                  Margin="0,20,0,10" Width="200" Height="25"
                 HorizontalAlignment="Center"
                 VerticalAlignment="Top"/>
        <!-- Grid with Column Definitions -->
        <Grid Margin="10,30,10,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Margin="0,50,0,29">
                <!-- Search Available Flashcards-->
                <TextBlock Text="Search Flashcards:" HorizontalAlignment="Center"/>
                <TextBox Width="200" Height="25" Margin="0,0,0,5"
                         Text="{Binding SearchAvailableText, UpdateSourceTrigger=PropertyChanged}" />
                <!-- Available Flashcards -->
                <DataGrid ItemsSource="{Binding FilteredAvailableFlashcards }" 
                      AutoGenerateColumns="False" 
                      SelectionMode="Extended" 
                      Grid.Column="0"
                      IsReadOnly="True" Margin="0,10,0,42">
                    <DataGrid.Columns>
                        <DataGridTemplateColumn Header="Select" Width="Auto">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, 
                                                         Path=DataContext.ToggleAvailableFlashcardSelectionCommand}"
                                          CommandParameter="{Binding Id}"
                                          IsChecked="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, 
                                                         Path=DataContext.SelectedAvailableFlashcards[{Binding Id}], 
                                                         Mode=TwoWay}" />
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Flashcard front" Binding="{Binding Front}" Width="*" />
                        <DataGridTextColumn Header="Flashcard back" Binding="{Binding Back}" Width="*" />
                    </DataGrid.Columns>
                </DataGrid>
            </StackPanel>
            
            <!-- Add/Remove Buttons -->
            <StackPanel Orientation="Vertical" HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Column="1">
                <Button Content="&lt;-" Width="50" Height="30" Margin="5"
                        Command="{Binding RemoveFlashcardsCommand}" 
                        IsEnabled="{Binding IsRemoveButtonEnabled}" />

                <Button Content="-&gt;" Width="50" Height="30" Margin="5"
                        Command="{Binding AddFlashcardsCommand}" 
                        IsEnabled="{Binding IsAddButtonEnabled}" />
            </StackPanel>

            <!-- Selected Flashcards (Deck) -->

                <StackPanel Grid.Column="2" Margin="0,48,0,28">
                <!-- Search Deck Flashcards -->
                <TextBlock Text="Search Flashcards:" HorizontalAlignment="Center"/>
                <TextBox Width="200" Height="25" Margin="0,0,0,5"
                         Text="{Binding SearchSelectedText, UpdateSourceTrigger=PropertyChanged}" />
                <!-- DataGrid for Deck Flashcards -->
                <DataGrid ItemsSource="{Binding FilteredSelectedFlashcards}" 
                          AutoGenerateColumns="False" 
                          SelectionMode="Extended" 
                          IsReadOnly="True" Margin="0,10,0,27">
                    <DataGrid.Columns>
                        <DataGridTemplateColumn Header="Select" Width="Auto">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, 
                                                         Path=DataContext.ToggleDeckFlashcardSelectionCommand}"
                                              CommandParameter="{Binding Id}"
                                              IsChecked="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, 
                                                         Path=DataContext.SelectedDeckFlashcards[{Binding Id}], 
                                                         Mode=TwoWay}" />
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Flashcard front" Binding="{Binding Front}" Width="*" />
                        <DataGridTextColumn Header="Flashcard back" Binding="{Binding Back}" Width="*" />
                    </DataGrid.Columns>
                </DataGrid>
            </StackPanel>

        </Grid>

        <!-- Save Deck Button -->
        <Button Content="Save Deck" Command="{Binding SaveDeckCommand}"
                HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="10" 
                IsEnabled="{Binding IsSaveButtonEnabled}" />
    </Grid>
</UserControl>
